<include file="Public:header" />


<div class="wrapper">
	<div class='block j-block'></div>
	<div class="my-container">
		<div class="topSearch">
			<form id="search-form" action="{:U('Index/search')}" method="get">
				<input type="text" id="search-text" name="key" placeholder="示例" autocomplete="off" class="inputText"/>
				<input type="hidden" id="search-day" name="day" value="3" />
				<input type="hidden" id="search-price" name="price" value="300-600" />
				<a href="#" id="search-route" class="my-btn">搜路线</a>
				<ul id="tips-ul" class="tips-dialog">
				</ul>
			</form>
			<div class="clear"></div>
		</div>
		<div id="condition" class="condition">
			<h3>筛选条件</h3>
			<p class='condition-day'>
				<span>天数： </span>
				<ul class="nav nav-pills">
					<li class="active">
						<a href="#">不限</a>
					</li>
					<li><a href="#">3天</a></li>
					<li><a href="#">4天</a></li>
					<li><a href="#">5天</a></li>
				</ul>
			</p>
			<p class='condition-price'>
				<span>预算： </span>
				<ul class="nav nav-pills">
					<li class="active">
						<a href="#">不限</a>
					</li>
					<li><a href="#">0-300</a></li>
					<li><a href="#">300-600</a></li>
					<li><a href="#">600-900</a></li>
					<li><a href="#">900-1200</a></li>
				</ul>
			</p>
			<p class='condition-price'>
				<span>排序： </span>
				<ul class="nav nav-pills">
					<li class="active">
						<a href="#">热度</a>
					</li>
					<li><a href="#">价格</a></li>
					<li><a href="#">距离</a></li>
				</ul>
			</p>
		</div>

		<div class="routediv">
			<!--<h2>搜索结果</h2>-->
			<!--<p class='sort'>-->
				<!--<span>排序：</span>-->
				<!--<a href="#">热度</a>-->
				<!--<a href="#">价格</a>-->
				<!--<a href="#">距离</a>-->
			<!--</p>-->

			<div class="r-unit clearfix">


			</div>
			<div class="r-unit clearfix">


			</div>
			<div class="r-unit clearfix">


			</div>

		</div>

	</div>

	<div class="bg"></div>

</div>
<script type="text/javascript" src="__JS__/lazyload.js"> </script>
<script type="text/javascript" src="__JS__/search.js"></script>
<script type="text/javascript">

	window.onload = function(){
		$('.lazy').lazyload({"threshold":0});
	}
	$(document).ready(function(){
		$('#search-text').keyup(function(){
			var key = $(this).val();
			if (key == null || key == "") {
				$("#tips-ul").hide();
				return ;
			};
			$("#tips-ul").slideDown();
			console.log(key);
			ajaxGet(key);
		});

		$('#search-city').click(function(e){
			$("#search-form").submit();
		});

		$(document).keydown(function(e){
			if (e.keyCode == 13) {
				$("#search-form").submit();
			};
		});
	});

	function ajaxGet(key){
		$.ajax({
			method:'get',
			data:{'key': key},
			url:'{:U("Index/suggest")}',
			dataType:'json',
			success:function(result){
				console.log(result);
				var data = result.data;
				// console.log(result.info);
				if (data.length > 0) {
					var elemStr = replaceTpl("<li>{word}</li>",data);
					$("#tips-ul").empty();
					$("#tips-ul").append(elemStr);
					bindUlEvent();
				}
			}
		});
	}


	function bindUlEvent(){
		$("#tips-ul li").unbind("click");
		$("#tips-ul li").bind("click", function(e){
			var key = $(this).text();
			$("#search-text").val(key);
			$("#search-form").submit();
		});
	}
</script>

<include file="Public:footer" />
